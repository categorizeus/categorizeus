<html>
  <head>
	<script type="text/javascript" src="scripts/jquery-3.0.0.js"></script>
	<script type="text/javascript" src="scripts/handlebars-v4.0.5.js"></script>
	<script type="text/javascript" src="scripts/categorizeus.js"></script>
	<script type="text/javascript" src="scripts/mainui.js"></script>
	<link rel="stylesheet" type="text/css" href="css/categorizeus.css"></script>
	<link rel="stylesheet" type="text/css" href="css/mainui.css"></script>
	<script id="tmplBasicDocument" type="text/x-handlebars-template">
		<div class="basicDocument" id="{{id}}">
			<h1>{{title}}</h1>
			<div class="postedBy">
				posted by {{postedBy.userName}}
				<input type="checkbox" name="{{id}}" class="chkTag"/>Tag this?
			</div>
			<div class="body">
				{{body}}
			</div>
		</div>
	</script>
	<script id="tmplBasicDocumentEdit" type="text/x-handlebars-template">
		<div class="basicDocumentEdit">
			<input class="inputMsgId" type="hidden" name="messageId" value="{{id}}"/>
			<p>Title <input class="inputMsgTitle" type="text" value="{{title}}"/></p>
			<p>Body <textarea class="inputMsgBody" rows="4" cols="87" type="text">{{body}}</textarea></p>
			<input type="button" class="inputMsgBtn" value="Submit"/>
		</div>
	</script>
	<script id="tmplLogin" type="text/x-handlebars-template">
		<div class="login">
			<p>Username <input class="txtUsername" type="text"/></p>
			<p>Password <input class="txtPassword" type="password"/></p>
			<input type="button" class="btnLogin" value="Login"/>
		</div>
	</script>
		<script type="text/javascript">
			$(document).ready(function(){
				console.log("We're up");
				tmplBasicDocument = Handlebars.compile($("#tmplBasicDocument").html());
				tmplBasicDocumentEdit = Handlebars.compile($("#tmplBasicDocumentEdit").html());//notice the pattern
				tmplLogin = Handlebars.compile($("#tmplLogin").html());
				displayLoginForm(".userInfo");
				tagSearch([], displayMessages);
				$("#btnPost").click(function(){
					displayEditForm("#editor", {});
				});

				$("#btnSearch").click(function(){
					var tags = $("#txtTagSearch").val();
					var allTags = tags.split(" ");
					var tagArray = [];
					for(var i=0; i<allTags.length;i++){
						if(allTags[i].length>0){
							tagArray.push(allTags[i]);
						}
					}
					tagSearch(tagArray, displayMessages);	
				});

				$("#btnTag").click(function(){

					var tags = $("#txtTagSearch").val();
					var allTags = tags.split(" ");
					var tagArray = [];
					for(var i=0; i<allTags.length;i++){
						if(allTags[i].length>0){
							tagArray.push(allTags[i]);
						}		}

					var whichTagged = [];
					$('input:checkbox.chkTag').each(function () {
						if(this.checked){
							whichTagged.push(this.name);
						}
					});
					console.log(whichTagged);
					if(tagArray.length==0){
						$("#status").html("<h1>Please provide tags when tagging</h1>");
						return;
					}
					if(whichTagged.length==0){
						$("#status").html("<h1>Please select messages when tagging</h1>");
						return;
					}
					tagMessages(tagArray, whichTagged);
				});


			});
		</script>
  </head>
  <body>
    <div class="header">
	<div id="btnCategorizeUs" class="categorizeUsButton">categorize.us</div>
	<div id="btnNotifications" class="notificationsButton">Notifications</div>
	<input id="txtTagSearch" type="text" placeholder="tags to apply or search" width=100/>
	<div id="btnSearch" class="searchButton">Search</div>
	<div id="btnTag" class="tagButton">Tag</div>
	<div id="btnPost" class="postButton">Post</div>
	<div id="btnAbout" class="aboutButton">About</div>

    </div>
    <div id='main'>
      <div class="article">
	<div id="content">
	</div>
      </div>
      <div class="nav">
	<div id="status">
		<div class="userInfo">
			<input id="btnLogin" type="button" value="login"/>
		</div>
	</div>
	<div id="editor">

	</div>
      </div>
      <div class="aside unseen">
	(c) Keefe Roedersheimer
	icons courtesy https://thenounproject.com
	Specific Icon Credits:
	enso by Bluetip Design
	search by Bernar Novalyi
	tag by Bryn Taylor
	camera by Arthur Shlain
	thumbs by Justin Blake
	envelope by David Nesbitt
	about by Umesh Vgl
	edit by abhishek rana 
     </div>
    </div>
  </body>
</html>
